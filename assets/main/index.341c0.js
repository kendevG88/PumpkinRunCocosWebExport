window.__require=function t(e,o,n){function i(a,s){if(!o[a]){if(!e[a]){var c=a.split("/");if(c=c[c.length-1],!e[c]){var l="function"==typeof __require&&__require;if(!s&&l)return l(c,!0);if(r)return r(c,!0);throw new Error("Cannot find module '"+a+"'")}a=c}var p=o[a]={exports:{}};e[a][0].call(p.exports,function(t){return i(e[a][1][t]||t)},p,p.exports,t,e,o,n)}return o[a].exports}for(var r="function"==typeof __require&&__require,a=0;a<n.length;a++)i(n[a]);return i}({AnimController:[function(t,e,o){"use strict";cc._RF.push(e,"c38ebXnMwlO7r9Outlyx6O8","AnimController");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,o,a):i(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.AnimController=void 0;var a=t("./AnimInfo"),s=cc._decorator,c=s.ccclass,l=s.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.animatorName="animator name",e.frameDelay=.016666,e.animInfoList=[],e.animInfo=e.animInfoList[0],e.animTrackTime=0,e.animDuration=0,e.animInfoDictionary={},e.spriteRenderer=null,e}return i(e,t),e.prototype.onLoad=function(){this.spriteRenderer=this.node.getComponent(cc.Sprite),this.animInfo=this.animInfoList[0],this.init()},e.prototype.init=function(){this.animInfo=this.animInfoList[0],this.animTrackTime=0,this.animInfoDictionary={}},e.prototype.update=function(){this.setSpriteFrame()},e.prototype.setSpriteFrame=function(){this.spriteRenderer.spriteFrame=this.animSpriteFrame()},e.prototype.animSpriteFrame=function(){var t=this.animInfo.spriteFrames.length;if(this.animDuration=this.frameDelay*t,!this.animInfo.loop&&this.animTrackTime>=this.animDuration-this.frameDelay)return this.animInfo.spriteFrames[this.animInfo.spriteFrames.length-1];var e=cc.director.getDeltaTime();this.animTrackTime+=e*cc.game.timeScale;var o=Math.floor(this.animTrackTime%this.animDuration/this.frameDelay);return this.animInfo.spriteFrames[o%this.animInfo.spriteFrames.length]},e.prototype.setAnimByName=function(t){this.animInfoDictionary[t]||(this.animInfoDictionary[t]=this.animInfoList.find(function(e){return e.animName===t})),this.animInfo=this.animInfoDictionary[t]?this.animInfoDictionary[t]:this.animInfo},e.prototype.setAnimByIndex=function(t){this.animInfo=this.animInfoList[t],this.animInfoDictionary[this.animInfo.animName]=this.animInfo},e.prototype.setAnimTrackTime=function(t){this.animTrackTime=t},Object.defineProperty(e.prototype,"currentAnimName",{get:function(){try{return this.animInfo.animName}catch(s){return""}},enumerable:!1,configurable:!0}),r([l()],e.prototype,"animatorName",void 0),r([l()],e.prototype,"frameDelay",void 0),r([l({type:[a.AnimInfo],serializable:!0})],e.prototype,"animInfoList",void 0),r([c],e)}(cc.Component);o.AnimController=p,cc._RF.pop()},{"./AnimInfo":"AnimInfo"}],AnimInfo:[function(t,e,o){"use strict";cc._RF.push(e,"8c5249Hsh5H8p2C0mqJvzZI","AnimInfo");var n=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,o,a):i(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.AnimInfo=void 0;var i=cc._decorator,r=i.ccclass,a=i.property,s=function(){function t(){this.animName="anim name",this.loop=!1,this.spriteFrames=[]}return n([a()],t.prototype,"animName",void 0),n([a()],t.prototype,"loop",void 0),n([a(cc.SpriteFrame)],t.prototype,"spriteFrames",void 0),n([r("AnimInfo")],t)}();o.AnimInfo=s,cc._RF.pop()},{}],AudioManager:[function(t,e,o){"use strict";cc._RF.push(e,"6d04fxWLnxABrZiJAzF5Wsx","AudioManager");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,o,a):i(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.Sound=void 0;var a,s=cc.Node,c=cc._decorator,l=c.ccclass,p=c.property;(function(t){t[t.Sound=0]="Sound",t[t.Music=1]="Music"})(a||(a={}));var u=function(){function t(){this.name="",this.audioSource=null,this.clip=null,this.type=a.Sound,this.volume=1}return r([p],t.prototype,"name",void 0),r([p(cc.AudioClip)],t.prototype,"clip",void 0),r([p({type:cc.Enum(a),serializable:!0})],t.prototype,"type",void 0),r([p({type:cc.Float,range:[0,1]})],t.prototype,"volume",void 0),r([l("Sound")],t)}();o.Sound=u;var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sounds=[],e.playOneShotAudioSource=null,e}var o;return i(e,t),o=e,e.prototype.onLoad=function(){o.Inst=this,this.setDefaults(),this.initPlayOneShotAudioSource()},e.prototype.setDefaults=function(){cc.sys.localStorage.getItem("SetDefaultVolumeIsDone")||(cc.sys.localStorage.setItem("SetDefaultVolumeIsDone","1"),this.musicVolume=1,this.soundVolume=1)},e.prototype.initPlayOneShotAudioSource=function(){this.playOneShotAudioSource=this.node.addComponent(cc.AudioSource)},e.prototype.playOneShot=function(t){var e=this.sounds.find(function(e){return e.name===t});e?this.playOneShotClip(e.clip):console.warn("Sound '"+t+"' not found.")},e.prototype.playOneShotClip=function(t){this.playOneShotAudioSource.clip=t,this.playOneShotAudioSource.volume=this.soundVolume,this.playOneShotAudioSource.play()},e.prototype.play=function(t,e){void 0===e&&(e=!1);var o=this.sounds.find(function(e){return e.name===t});o?this.playAudioSource(o):console.warn("Sound '"+t+"' not found.")},e.prototype.playAudioSource=function(t){null===t.audioSource&&(t.audioSource=this.createAudioSourceNode(),t.audioSource.loop=t.loop,t.audioSource.clip=t.clip),t.audioSource.volume=t.volume*(t.type===a.Sound?this.soundVolume:this.musicVolume),t.audioSource.play()},e.prototype.createAudioSourceNode=function(t){return void 0===t&&(t=""),new s(t),this.node.addComponent(cc.AudioSource)},e.prototype.stop=function(t){var e=this.node.getComponent(cc.AudioSource);e&&e.clip&&e.clip.name===t&&e.stop()},e.prototype.onInspectorChanged=function(){this.sounds.forEach(function(t){!t.name&&t.clip&&(t.name=t.clip.name)})},Object.defineProperty(e.prototype,"musicVolume",{get:function(){try{return parseFloat(cc.sys.localStorage.getItem("MusicVolume"))||1}catch(c){return cc.sys.localStorage.setItem("MusicVolume","1"),parseFloat(cc.sys.localStorage.getItem("MusicVolume"))||1}},set:function(t){cc.sys.localStorage.setItem("MusicVolume",t.toString()),this.sounds.forEach(function(e){e.type===a.Music&&(e.audioSource.volume=t)})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"soundVolume",{get:function(){try{return parseFloat(cc.sys.localStorage.getItem("SoundVolume"))||1}catch(c){return cc.sys.localStorage.setItem("SoundVolume","1"),parseFloat(cc.sys.localStorage.getItem("SoundVolume"))||1}},set:function(t){cc.sys.localStorage.setItem("SoundVolume",t.toString()),this.sounds.forEach(function(e){e.type===a.Sound&&(e.audioSource.volume=t)})},enumerable:!1,configurable:!0}),r([p({type:[u],serializable:!0})],e.prototype,"sounds",void 0),o=r([l],e)}(cc.Component);o.default=f,cc._RF.pop()},{}],BgManager:[function(t,e,o){"use strict";cc._RF.push(e,"f90e04GtkRD3LtbcE3EaPlk","BgManager");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,o,a):i(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.GroundLoopInfo=void 0;var a=t("../GameManager"),s=cc._decorator,c=s.ccclass,l=s.property,p=function(){function t(){this.node=null,this.speed=1}return r([l(cc.Node)],t.prototype,"node",void 0),r([l()],t.prototype,"speed",void 0),r([c("GroundLoopInfo")],t)}();o.GroundLoopInfo=p;var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.groundSprites=[],e.ground=null,e.gameManager=null,e.groundLoopInfos=[],e.bgWidth=2e3,e.bgOffset=0,e.aroundMultiples=0,e}return i(e,t),e.prototype.onLoad=function(){cc.game.timeScale=1,this.bgOffset=0,this.calculationAroundMultiples(),this.setGroundSprite()},e.prototype.calculationAroundMultiples=function(){var t=this;for(this.aroundMultiples=1e12,this.groundLoopInfos.forEach(function(e){t.aroundMultiples*=e.speed});this.aroundMultiples%10==0;)this.aroundMultiples/=10},e.prototype.setGroundSprite=function(){var t=Math.floor(Math.random()*this.groundSprites.length);this.ground.spriteFrame=this.groundSprites[t]},e.prototype.update=function(){this.updateBgOffset(),this.setBgDisplay()},e.prototype.updateBgOffset=function(){this.bgOffset-=cc.game.timeScale*cc.director.getDeltaTime()*this.gameManager.runSpeed,this.bgOffset%=this.aroundMultiples*this.bgWidth},e.prototype.setBgDisplay=function(){var t=this;this.groundLoopInfos.forEach(function(e){var o=t.bgOffset*e.speed%t.bgWidth;e.node.setPosition(o,e.node.position.y)})},r([l(cc.SpriteFrame)],e.prototype,"groundSprites",void 0),r([l(cc.Sprite)],e.prototype,"ground",void 0),r([l(a.default)],e.prototype,"gameManager",void 0),r([l({type:[p],serializable:!0})],e.prototype,"groundLoopInfos",void 0),r([c],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../GameManager":"GameManager"}],GameManager:[function(t,e,o){"use strict";cc._RF.push(e,"0fce73nVZlMpoFusdRp52WB","GameManager");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,o,a):i(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.GamePlayState=void 0;var a,s=t("./Obstacle/ObstacleInfo"),c=cc._decorator,l=c.ccclass,p=c.property;(function(t){t[t.Intro=0]="Intro",t[t.Playing=1]="Playing",t[t.Over=2]="Over"})(a=o.GamePlayState||(o.GamePlayState={}));var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.fpsTarget=60,e.gamePlayState=a.Intro,e.scoreText=null,e.bestScoreText=null,e.gameOverTitle=null,e.startButton=null,e.jumpButton=null,e.obstacleContainer=null,e.runSpeed=30,e.speedUpCoefficient=1e3,e.maxSpeed=1,e.bgWidth=2e3,e.obstacleDistance=200,e.obstacleInfos=[],e.runDistance=0,e.scoreByCollected=0,e}var o;return i(e,t),o=e,e.prototype.onLoad=function(){o.inst=this,this.bestScoreText.string="Best Score: "+this.bestScore,this.initGameTime(),this.initNodePool(),this.enablePhysic()},e.prototype.start=function(){cc.game.setFrameRate(this.fpsTarget)},e.prototype.initGameTime=function(){o.gameTimer=0,o.deltaTime=0,o.unscaleDeltaTime=0,o.unscaleGameTimer=0,o.timeScale=1},e.prototype.updateGameTime=function(){o.unscaleDeltaTime=cc.director.getDeltaTime(),o.deltaTime=o.unscaleDeltaTime*o.timeScale,o.unscaleGameTimer+=o.unscaleDeltaTime,o.gameTimer+=o.deltaTime},e.prototype.initNodePool=function(){},e.prototype.enablePhysic=function(){var t=cc.director.getPhysicsManager();t.enabled=!0,t.gravity=cc.v2(0,-1e3)},e.prototype.checkInstanceObstacle=function(){this.runDistance+.5*this.bgWidth>o.newObstacleInstancePos&&this.instantiateObstacle()},e.prototype.instantiateObstacle=function(){var t=Math.floor(Math.random()*this.obstacleInfos.length),e=this.obstacleInfos[t];do{o.newObstacleInstancePos+=e.instantiateDistance,cc.instantiate(e.prefab).parent=this.obstacleContainer}while(Math.random()<e.doubleInstantiateRate);o.newObstacleInstancePos+=400*Math.random()+200},e.prototype.newGame=function(){this.gameOverTitle.active=!1,this.startButton.active=!1,this.jumpButton.active=!0,cc.game.timeScale=1,this.runDistance=0,this.scoreByCollected=0,o.newObstacleInstancePos=0,this.gamePlayState=a.Playing},e.prototype.update=function(){this.updateGameTime(),this.runDistanceUp(),this.gamePlayState===a.Playing&&(this.setGameSpeed(),this.checkInstanceObstacle(),this.scoreHandler(this.totalScore))},e.prototype.runDistanceUp=function(){var t=cc.director.getDeltaTime()*cc.game.timeScale*this.runSpeed;this.runDistance+=t},e.prototype.setGameSpeed=function(){var t=1e5/this.speedUpCoefficient;o.timeScale=this.maxSpeed-t/(t+this.runDistance)*(this.maxSpeed-1),cc.game.timeScale=o.timeScale},e.prototype.gameOver=function(){this.gamePlayState=a.Over,this.gameOverTitle.active=!0,this.startButton.active=!0,this.jumpButton.active=!1,cc.game.timeScale=0},e.prototype.scoreHandler=function(t){this.scoreText.string="Score: "+t,t>=this.bestScore&&(this.bestScore=t,this.bestScoreText.string="Best Score: "+t)},Object.defineProperty(e.prototype,"totalScore",{get:function(){return Math.floor(this.scoreByCollected+.005*this.runDistance)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bestScore",{get:function(){return cc.sys.localStorage.getItem("bestScore")},set:function(t){cc.sys.localStorage.setItem("bestScore",t.toString())},enumerable:!1,configurable:!0}),e.newObstacleInstancePos=0,r([p()],e.prototype,"fpsTarget",void 0),r([p({type:cc.Enum(a)})],e.prototype,"gamePlayState",void 0),r([p(cc.Label)],e.prototype,"scoreText",void 0),r([p(cc.Label)],e.prototype,"bestScoreText",void 0),r([p(cc.Node)],e.prototype,"gameOverTitle",void 0),r([p(cc.Node)],e.prototype,"startButton",void 0),r([p(cc.Node)],e.prototype,"jumpButton",void 0),r([p(cc.Node)],e.prototype,"obstacleContainer",void 0),r([p],e.prototype,"runSpeed",void 0),r([p],e.prototype,"speedUpCoefficient",void 0),r([p],e.prototype,"maxSpeed",void 0),r([p],e.prototype,"bgWidth",void 0),r([p],e.prototype,"obstacleDistance",void 0),r([p({type:[s.ObstacleInfo],serializable:!0})],e.prototype,"obstacleInfos",void 0),o=r([l],e)}(cc.Component);o.default=u,cc._RF.pop()},{"./Obstacle/ObstacleInfo":"ObstacleInfo"}],JumpButton:[function(t,e,o){"use strict";cc._RF.push(e,"b689bmIIXxK2aGyrEhfCKmv","JumpButton");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,o,a):i(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../Player/PlayerController"),s=cc._decorator,c=s.ccclass,l=s.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.playerController=null,e}return i(e,t),e.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchScreen,this)},e.prototype.onDestroy=function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchScreen,this)},e.prototype.onTouchScreen=function(){this.playerController.onUserPlay()},r([l(a.default)],e.prototype,"playerController",void 0),r([c],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../Player/PlayerController":"PlayerController"}],KeyHandler:[function(t,e,o){"use strict";cc._RF.push(e,"689c7QCPRpNlLTjPzlAU+VU","KeyHandler");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,o,a):i(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator.ccclass,s={8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause/Break",20:"Caps Lock",27:"Escape",32:"Space",33:"Page Up",34:"Page Down",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",45:"Insert",46:"Delete",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",91:"Left Window Key",92:"Right Window Key",93:"Select Key",96:"Numpad 0",97:"Numpad 1",98:"Numpad 2",99:"Numpad 3",100:"Numpad 4",101:"Numpad 5",102:"Numpad 6",103:"Numpad 7",104:"Numpad 8",105:"Numpad 9",106:"Multiply",107:"Add",109:"Subtract",110:"Decimal Point",111:"Divide",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"Num Lock",145:"Scroll Lock",186:"Semicolon",187:"Equal Sign",188:"Comma",189:"Dash",190:"Period",191:"Forward Slash",192:"Grave Accent",219:"Open Bracket",220:"Back Slash",221:"Close Bracket",222:"Single Quote"},c={},l=[],p=[],u=[],f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.onLoad=function(){cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyReleased,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyPressed,this)},e.prototype.onKeyPressed=function(t){var e=s[t.keyCode+""];c[e]||(c[e]=!0,this.callKeyEventActions(l,e)),this.callKeyEventActions(p,e)},e.prototype.onKeyReleased=function(t){var e=s[t.keyCode+""];c[e]=!1,this.callKeyEventActions(u,e)},e.prototype.callKeyEventActions=function(t,e){t.forEach(function(t){t&&t(e)})},e.addKeyDownAction=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];l=l.concat(t)},e.addKeyHeldAction=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];p=p.concat(t)},e.addKeyUpAction=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];u=u.concat(t)},e.removeKeyDownAction=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t.forEach(function(t){var e=l.indexOf(t);-1!==e&&l.splice(e,1)})},e.removeKeyHeldAction=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t.forEach(function(t){var e=p.indexOf(t);-1!==e&&p.splice(e,1)})},e.removeKeyUpAction=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t.forEach(function(t){var e=u.indexOf(t);-1!==e&&u.splice(e,1)})},r([a],e)}(cc.Component);o.default=f,cc._RF.pop()},{}],MissionInfo:[function(t,e,o){"use strict";cc._RF.push(e,"5145f6qnsRPhqVHnfjbVMS+","MissionInfo");var n,i,r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,o,a):i(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.MissionInfo=o.MissionName=o.MissionType=void 0,function(t){t[t.PlayGame=0]="PlayGame",t[t.KillZombie=1]="KillZombie",t[t.CandyCollecting=2]="CandyCollecting",t[t.ScoreAchievement=3]="ScoreAchievement",t[t.MultiStomp=4]="MultiStomp",t[t.Pacifist=5]="Pacifist"}(n=o.MissionType||(o.MissionType={})),function(t){t[t["Gold Star"]=0]="Gold Star",t[t["Record Breaker"]=1]="Record Breaker",t[t["Spooky Run"]=2]="Spooky Run",t[t["Crazy Run"]=3]="Crazy Run",t[t["Nightmare Run"]=4]="Nightmare Run",t[t["Smashed Pumpkin"]=5]="Smashed Pumpkin",t[t["Double Stomp"]=6]="Double Stomp",t[t["Head Surfer"]=7]="Head Surfer",t[t["Skull Cracker"]=8]="Skull Cracker",t[t["Candy Lover"]=9]="Candy Lover",t[t.Pacifist=10]="Pacifist"}(i=o.MissionName||(o.MissionName={}));var a=cc._decorator,s=a.ccclass,c=a.property,l=function(){function t(){this.missionType=n.PlayGame,this.missionName=i["Gold Star"],this.description="",this.icon=null,this.target=0,this.isOneGameMission=!0,this._gamePlayProgress=0,this.callBack=null}return Object.defineProperty(t.prototype,"gamePlayProgress",{get:function(){return this._gamePlayProgress?this._gamePlayProgress:0},set:function(t){t>=this.target&&!this.missionCompleted&&(this.callBack(this),this.missionCompleted=!0),this._gamePlayProgress=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"missionCompleted",{get:function(){return this.gamePlayProgress>=this.target||(cc.sys.localStorage.getItem("Mission"+this.missionType+this.missionName)||!1)},set:function(t){cc.sys.localStorage.setItem("Mission"+this.missionType+this.missionName,t)},enumerable:!1,configurable:!0}),t.prototype.resetGamePlayProgress=function(){this.isOneGameMission&&!this.missionCompleted&&(this.gamePlayProgress=0)},r([c({type:cc.Enum(n)})],t.prototype,"missionType",void 0),r([c({type:cc.Enum(i)})],t.prototype,"missionName",void 0),r([c()],t.prototype,"description",void 0),r([c(cc.SpriteFrame)],t.prototype,"icon",void 0),r([c()],t.prototype,"target",void 0),r([c()],t.prototype,"isOneGameMission",void 0),r([s("MissionInfo")],t)}();o.MissionInfo=l,cc._RF.pop()},{}],MissionManager:[function(t,e,o){"use strict";cc._RF.push(e,"65421SOZ5xG16pVdzLsnmdp","MissionManager");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,o,a):i(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=t("./MissionInfo"),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.missionInfos=[],e}var o;return i(e,t),o=e,e.prototype.onLoad=function(){o.Inst=this,this.loadData(),this.addCallBackOnMissionCompleted()},e.prototype.loadData=function(){var t=cc.sys.localStorage.getItem("MissionProgressData");t&&(this.missionProgress=JSON.parse(t))},e.prototype.saveData=function(){var t=JSON.stringify(this.missionProgress);cc.sys.localStorage.setItem("MissionProgressData",t)},e.prototype.addCallBackOnMissionCompleted=function(){this.missionInfos.forEach(function(t){t.callBack=this.onMissionCompleted})},e.prototype.onNewGame=function(){this.resetAllGamePlayProgress()},e.prototype.onContactGround=function(){this.resetMultiStompMissionProgress()},e.prototype.onDead=function(){this.saveData()},e.prototype.onStompZombie=function(){this.upMultiStompMission()},e.prototype.onContactCandy=function(){this.upCandyCollectedAmount()},e.prototype.onMissionCompleted=function(){},e.prototype.checkScore=function(t){100!==t&&500!==t&&1e3!==t&&1500!==t||this.checkNewHeightScore(t)},e.prototype.resetAllGamePlayProgress=function(){this.missionInfos.forEach(function(t){t.resetGamePlayProgress()})},e.prototype.upMultiStompMission=function(){this.missionInfos.forEach(function(t){t.missionType===l.MissionType.MultiStomp&&(t.gamePlayProgress+=1)})},e.prototype.resetMultiStompMissionProgress=function(){this.missionInfos.forEach(function(t){t.missionType===l.MissionType.MultiStomp&&t.resetGamePlayProgress()})},e.prototype.upCandyCollectedAmount=function(){this.missionInfos.forEach(function(t){t.missionType===l.MissionType.CandyCollecting&&(t.gamePlayProgress+=1)})},e.prototype.checkNewHeightScore=function(t){this.missionInfos.forEach(function(e){e.missionType===l.MissionType.ScoreAchievement&&(e.gamePlayProgress=t)})},r([c({type:[l.MissionInfo],serializable:!0})],e.prototype,"missionInfos",void 0),o=r([s],e)}(cc.Component);o.default=p,cc._RF.pop()},{"./MissionInfo":"MissionInfo"}],ObstacleController:[function(t,e,o){"use strict";cc._RF.push(e,"cb3160tK6JPWaP1P7hevtpk","ObstacleController");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,o,a):i(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../GameManager"),s=t("../Animator/AnimController"),c=t("../Player/PlayerController"),l=cc._decorator,p=l.ccclass,u=l.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.instantiatePos=0,e.stampPosY=0,e.obstacleIsOver=!1,e.selfRoundIsOver=!1,e.rb=null,e.moveSpeed=0,e}return i(e,t),e.prototype.onLoad=function(){this.moveSpeed*=Math.random()+.2,this.instantiatePos=a.default.newObstacleInstancePos,this.collider=this.node.getComponent(cc.PhysicsCollider),this.rb=this.node.getComponent(cc.RigidBody),this.stampPosY=this.node.position.y,this.getAnimatorController(),this.updatePos()},e.prototype.getAnimatorController=function(){var t=this,e=Math.floor(Math.random()*this.node.childrenCount),o=this.node.children[e];this.animController=o.getComponent(s.AnimController),this.node.children.forEach(function(o,n){o.active=n===e,console.log("-------Get animator controller: "+t.node.name+"  index: "+n+"   random Index "+e)})},e.prototype.update=function(){this.updatePos(),this.checkOutMapDestroy()},e.prototype.updatePos=function(){if(this.checkBreakOnGameOver(),this.selfRoundIsOver)this.rb.linearVelocity=new cc.Vec2(0,0);else{var t=this.instantiatePos-a.default.inst.runDistance+.5*a.default.inst.bgWidth,e=t+(t-c.default.Inst.node.position.x)*this.moveSpeed*.01,o=e-this.node.position.x;this.rb.linearVelocity=new cc.Vec2(o,0),this.node.setPosition(e,this.stampPosY)}},e.prototype.checkBreakOnGameOver=function(){a.default.inst.gamePlayState!==a.GamePlayState.Over||this.selfRoundIsOver||(this.selfRoundIsOver=!0,this.collider.enabled=!1),this.selfRoundIsOver&&a.default.inst.gamePlayState!==a.GamePlayState.Over&&this.node.destroy()},e.prototype.checkOutMapDestroy=function(){this.node.position.x<-.5*a.default.inst.bgWidth&&this.node.destroy()},e.prototype.breakObstacle=function(){var t=this;this.obstacleIsOver=!0,this.animController.setAnimByName("break"),this.animController.setAnimTrackTime(0),this.scheduleOnce(function(){t.node.destroy()},1)},r([u()],e.prototype,"moveSpeed",void 0),r([p()],e)}(cc.Component);o.default=f,cc._RF.pop()},{"../Animator/AnimController":"AnimController","../GameManager":"GameManager","../Player/PlayerController":"PlayerController"}],ObstacleInfo:[function(t,e,o){"use strict";cc._RF.push(e,"1ca4eh7RC1K74+hRdWTi1pc","ObstacleInfo");var n=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,o,a):i(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.ObstacleInfo=void 0;var i=cc._decorator,r=i.ccclass,a=i.property,s=function(){function t(){this.instantiateDistance=1,this.doubleInstantiateRate=0,this.prefab=null}return n([a()],t.prototype,"instantiateDistance",void 0),n([a()],t.prototype,"doubleInstantiateRate",void 0),n([a(cc.Prefab)],t.prototype,"prefab",void 0),n([r("ObstacleInfo")],t)}();o.ObstacleInfo=s,cc._RF.pop()},{}],PlayerController:[function(t,e,o){"use strict";cc._RF.push(e,"1b389P71lhGZLCiHRVGbO/6","PlayerController");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,o,a):i(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../Control/KeyHandler"),s=t("../GameManager"),c=t("../Obstacle/ObstacleController"),l=t("../Manager/AudioManager"),p=t("../Animator/AnimController"),u=cc._decorator,f=u.ccclass,d=u.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.jumpForce=500,e.slideDuration=1,e.skinContainer=null,e.downCollider=null,e.runCollider=null,e.slideCollider=null,e.animControllers=[],e.animController=null,e.deltaTime=0,e.slideTimer=0,e._inst=e,e.playerStampPosX=0,e}var o;return i(e,t),o=e,e.prototype.onLoad=function(){o.Inst=this,this.rb=this.node.getComponent(cc.RigidBody),this.playerStampPosX=this.node.position.x,this.getColliders(),this.getCharacterAnimControllers(),this.setSkinDisplay(),a.default.addKeyDownAction(this.onKeyDown.bind(this)),a.default.addKeyHeldAction(this.onKeyHeld.bind(this)),a.default.addKeyUpAction(this.onKeyUp.bind(this))},e.prototype.enableContactListener=function(){this.rb=this.node.getComponent(cc.RigidBody)},e.prototype.getColliders=function(){var t=this;this.node.getComponents(cc.PhysicsCollider).forEach(function(e){switch(e.tag){case 0:t.downCollider=e;break;case 1:t.runCollider=e;break;case 2:t.slideCollider=e}})},e.prototype.getCharacterAnimControllers=function(){var t=this;this.animControllers=[],this.skinContainer.children.forEach(function(e){t.animControllers.push(e.getComponent(p.AnimController))}),this.animController=this.animControllers[o.SkinIndex]},e.prototype.setSkinDisplay=function(){this.animControllers.forEach(function(t,e){t.node.active=e===o.SkinIndex})},e.prototype.update=function(){this.node.setPosition(this.playerStampPosX,this.node.position.y),this.getDeltaTime(),this.checkEndSlide()},e.prototype.getDeltaTime=function(){this.deltaTime=cc.director.getDeltaTime()},e.prototype.onKeyDown=function(t){"Down"===t&&s.default.inst.gamePlayState===s.GamePlayState.Playing&&this.slide()},e.prototype.onKeyHeld=function(t){"Space"!==t&&"Up"!==t||this.onUserPlay()},e.prototype.onKeyUp=function(){},e.prototype.onUserPlay=function(){s.default.inst.gamePlayState===s.GamePlayState.Playing?this.jump(this.jumpForce):s.default.inst.newGame()},e.prototype.onBeginContact=function(t,e,o){e===this.downCollider?this.onDownColliderContact(o):e!==this.runCollider&&e!==this.slideCollider||this.onUpColliderContact(o)},e.prototype.onDownColliderContact=function(t){"default"===t.node.group?this.changeRunAnim():"Obstacle"===t.node.group?this.checkDead(t):"Zombie"===t.node.group?this.pumpZombie(t.node):"Candy"===t.node.group&&this.contactCandy(t.node)},e.prototype.onUpColliderContact=function(t){"Candy"===t.node.group?this.contactCandy(t.node):"Obstacle"!==t.node.group&&"Zombie"!==t.node.group||this.checkDead(t)},e.prototype.changeRunAnim=function(){this.setAnimByName("run"),this.enableRunCollider()},e.prototype.pumpZombie=function(t){if(!(this.rb.linearVelocity.y>=0)){var e=t.getComponent(c.default);e.obstacleIsOver||e.selfRoundIsOver||(this.setAnimByName("run"),this.jump(.7*this.jumpForce),e.breakObstacle(),l.default.Inst.play("hit"),s.default.inst.scoreByCollected+=3)}},e.prototype.contactCandy=function(t){console.log("----------contact candy");var e=t.getComponent(c.default);e.obstacleIsOver||e.selfRoundIsOver||(l.default.Inst.play("hit"),s.default.inst.scoreByCollected+=2,e.breakObstacle())},e.prototype.jump=function(t){if("jump"!==this.getCurrentAnimName()){var e=cc.director.getDeltaTime()/.0166,o=cc.game.timeScale*e;this.rb.gravityScale=o*o,this.rb.linearVelocity=cc.v2(0,t).mul(o),this.enableRunCollider(),this.setAnimByName("jump"),this.setAnimTrackTime(0)}},e.prototype.slide=function(){"run"===this.getCurrentAnimName()&&(this.enableSlideCollider(),this.setAnimByName("slide"),this.setAnimTrackTime(0),this.slideTimer=this.slideDuration)},e.prototype.enableRunCollider=function(){this.slideCollider.enabled=!1,this.runCollider.enabled=!0},e.prototype.enableSlideCollider=function(){this.slideCollider.enabled=!0,this.runCollider.enabled=!1},e.prototype.checkEndSlide=function(){this.slideTimer>0&&(this.slideTimer-=cc.game.timeScale*this.deltaTime),this.slideTimer<=0&&this.endSlide()},e.prototype.endSlide=function(){"slide"===this.getCurrentAnimName()&&this.changeRunAnim()},e.prototype.getCurrentAnimName=function(){return this.animController.currentAnimName},e.prototype.setAnimByName=function(t){this.animController.setAnimByName(t)},e.prototype.setAnimTrackTime=function(t){this.animController.setAnimTrackTime(t)},e.prototype.checkDead=function(t){var e=t.node.getComponent(c.default);e.obstacleIsOver||e.selfRoundIsOver||(e.selfRoundIsOver=!0,l.default.Inst.play("over"),s.default.inst.gameOver())},e.SkinIndex=0,r([d],e.prototype,"jumpForce",void 0),r([d],e.prototype,"slideDuration",void 0),r([d(cc.Node)],e.prototype,"skinContainer",void 0),o=r([f],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../Animator/AnimController":"AnimController","../Control/KeyHandler":"KeyHandler","../GameManager":"GameManager","../Manager/AudioManager":"AudioManager","../Obstacle/ObstacleController":"ObstacleController"}]},{},["AnimController","AnimInfo","BgManager","JumpButton","KeyHandler","GameManager","AudioManager","MissionInfo","MissionManager","ObstacleController","ObstacleInfo","PlayerController"]);